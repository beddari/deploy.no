<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="description" content="">
		<meta name="author" content="Jan Ivar Beddari">
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<style type="text/css">
			html {
				background: #111111;
				background-color: #111111; }
		</style>
		<link rel="stylesheet" href="../css/reveal.css">
		<link rel="stylesheet" href="../css/night.css" id="theme">
		<link rel="stylesheet" href="../css/main.css">

		<!-- Fullscreen images -->
		<link rel="stylesheet" href="fullscreen-img.css">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="../css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="../css/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="../lib/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">
			<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">

<section data-markdown data-separator="\n!SLIDE\n" data-vertical="\n!SLIDEDOWN\n"><script type="text/template">
# Omnibus
## my #packaginglove
_cfgmgmtcamp_
!SLIDE
## Just enough OS
!SLIDE
## Just enough packaging?
!SLIDE
## [@beddari](https://twitter.com/beddari)
on Twitter or Freenode
!SLIDE
# 1. What?
What is omnibus-style packaging?
!SLIDE
## _It is just vendoring!_
Gather your dependencies & bus them out
!SLIDE
## The conceptual workflow
1. Decide on a build prefix, maybe /opt/some_app
2. Build in all the dependencies, runtimes, etc
3. Build the app - only linking in stuff from /opt/some_app
4. Wrap /opt/some_app into deb or rpm using fpm
!SLIDE
# 2. Why?
</script>
</section>
<section fullscreen-img="beating_a_dead_horse_by_potatoehuman-d3fead4.jpg" fullscreen-size="contain">
</section>
<section data-markdown data-separator="\n!SLIDE\n" data-vertical="\n!SLIDEDOWN\n"><script type="text/template">
## _\#packagingsucks_
!SLIDE
* I like to use packages as my CI/CD artifact
* I promote omnibus packages as testable change sets
* Omnibus lets me worry (a bit) less about managing repos
* Less deps to resolve at provisioning == less trouble
!SLIDE
* JeOS + omnibus-packages gives me ... SPEED
  * Same process for Kickstarts, cloud images or containers
  * `fpm -s rpm -t dir` ...
  * Config management tool has a lot less to worry about
* Little need to master multi-deps packaging
</script>
</section>
<section fullscreen-img="low_fruit.jpg" fullscreen-size="contain">
</section>
<section data-markdown data-separator="\n!SLIDE\n" data-vertical="\n!SLIDEDOWN\n"><script type="text/template">
## Dreaming of a different world
* What if distros contained THEIR Pythons and Rubies and whatever they needed?
* What if distros and upstream made friends <3 and together grew a toolset for rapid provisioning of full stacks?
* What if we had a generic, sharable packaging DSL?
!SLIDE
## Not a dream after all?
* Pleaserun abstracts init scripts (Jordan Sissel is my hero)
* The concept of a OS is changing
!SLIDE
# 3. How?
Meanwhile, back on planet earth
!SLIDE
## Tools of the trade
* omnibus-ruby
* fpm-cookery
* A lot of others like bunchr, pkgr ...
!SLIDE
## omnibus-ruby
* A Ruby DSL/gem first and foremost created for making Chef packages
* Uses Ohai to gather knowledge about a system
* Very usable also for generic packaging - it uses fpm after all
* Tooling around it is tied to Chef
!SLIDE
## omnibus-ruby gotchas!
* Not modeled for providing system packages as build-time deps
  * You could probably work around that
  * Complains if you link to anything outside the sandbox
* It is not straigthforward to host your own software library
!SLIDE
## fpm-cookery
* A gem that adds a generic packaging DSL on top of fpm
* Uses Puppet and Facter for abstractions
* DSL contains definition of both build- and deploytime package dependencies
!SLIDE
## fpm-cookery gotchas!
* Omnibus-enabled builds must be done as root
* No easy way of structuring internally dependent definitions; each project must have a copy of the Ruby definition file
* Ehm.. little or even no documentation. Use teh source! :-O
!SLIDE
## So ... ?
I use both!
!SLIDE
# 4. Let's try it!
!SLIDE
_References_

[Mathias Lafeldt: Cook your own packages](http://sysadvent.blogspot.be/2014/12/day-15-cook-your-own-packages-getting.html)

[Packaging Puppet using fpm-cookery, omnibus-style](https://github.com/andytinycat/puppet-omnibus)

[Puppet 4.0 will be a full-stack installer](https://groups.google.com/forum/#!topic/puppet-dev/qZ-nOvmfrig)

[Chef on the future of chef/omnibus](https://www.chef.io/blog/2014/06/30/omnibus-a-look-forward/)

[John E. Vincent: Omnibus'ing your way to happiness](http://sysadvent.blogspot.no/2013/12/day-16-omnibusing-your-way-to-happiness.html)

[Paul Czarkowski: Logstash + Opscode Omnibus](http://tech.paulcz.net/2013/05/logstash-plus-opscode-omnibus.html)


!SLIDE
## I'm for hire (remotely)
Current availability: October

[no.linkedin.com/in/beddari](http://no.linkedin.com/in/beddari)
</script></section>

</div>

		</div>

		<script src="../lib/head.min.js"></script>
		<script src="../lib/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
				center: true,

				transition: 'none', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: '../lib/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../lib/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../lib/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../lib/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'fullscreen-img.js' }
				]
			});

		</script>

        <script src="http://localhost:35729/livereload.js"></script>

	</body>
</html>
